---
title: Regularization in Manchester/eleanor corpus
author: Emmi Russo
date: "`r Sys.Date()`"
output: 
  html_document:
  toc: false
number_sections: false
theme: lumen
toc_float: false
code_folding: hide
---

```{r setup}
library(tidyverse)

utts <- read_csv("eleanor_utterance_data.csv", col_names = FALSE)
names(utts) <- c("utterance", "response", "response_time", "speaker", "responder", "utterance_time", "error", "age", "past_tense", "plural", "overlap", "source_file")

# coerce types, remove any wonky timing data
utts_clean <- utts %>%
  mutate_at(vars(age, response_time, utterance_time), as.numeric) %>%
  mutate_at(vars(error, past_tense, plural, overlap), as.logical) %>%
  filter(!((response_time < 0) & (!overlap))) %>%
  filter((-5 <= response_time) & (response_time <= 5) & (utterance_time <= 10))

kid_parent_utts <- utts_clean %>%
  filter((speaker == "CHI") & ((responder == "MOT") | (responder == "FAT")))

```

```{r get possible overregs}

overreg_candidates <- kid_parent_utts %>%
  mutate(overreg_candidate = ((past_tense | plural) & error)) 

sub_data <- kid_parent_utts %>%
  filter(past_tense | plural) 

sub_data %>%
  group_by(error) %>%
  filter(response_time > 0) %>%
  summarise(med_rt = median(log(response_time)),
            mean_rt = mean(log(response_time)))

sub_lm <- lm(response_time ~ utterance_time + age + error, sub_data)

or_lm <- lm(response_time ~ utterance_time + age + overreg_candidate, overreg_candidates)

ggplot(overreg_candidates, aes(x=response_time, fill=error)) + geom_density(alpha=.3) + scale_x_continuous(limits = c(-3, 3))
```

