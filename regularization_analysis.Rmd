---
title: Regularization in Thomas corpus
author: Dan Yurovsky
date: "`r Sys.Date()`"
output: 
  html_document:
  toc: false
number_sections: false
theme: lumen
toc_float: false
code_folding: hide
---


```{r setup, include = FALSE}
library(tidyverse)
library(knitr)
```


```{r read_data}
thomas_data <- read_csv("utterance_data.csv", col_names = FALSE)
names(thomas_data) <- c("utterance", "response", "response_time", "speaker", "responder", "utterance_time", "error", "age", "past_tense", "plural")

thomas_data_clean <- thomas_data %>%
  mutate(age = as.numeric(gsub("[^0-9]", "", age)),
         response_time = as.numeric(response_time)) %>%
  mutate_at(vars(error, past_tense, plural), as.logical)

kid_data <- thomas_data_clean %>%
  filter(speaker == "CHI") %>%
  filter(plural) %>%
  group_by(age, error) 

ggplot(kid_data, aes(x = response_time, fill = error)) + 
  geom_density(alpha = .2)


```